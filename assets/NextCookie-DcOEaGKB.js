import{C as N}from"./index--Cfhpedu.js";var g={},x={},A;function D(){if(A)return x;A=1,Object.defineProperty(x,"__esModule",{value:!0}),x.parse=e,x.serialize=n;const l=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,f=/^[\u0021-\u003A\u003C-\u007E]*$/,c=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,h=/^[\u0020-\u003A\u003D-\u007E]*$/,w=Object.prototype.toString,d=(()=>{const i=function(){};return i.prototype=Object.create(null),i})();function e(i,o){const a=new d,v=i.length;if(v<2)return a;const p=o?.decode||s;let u=0;do{const C=i.indexOf("=",u);if(C===-1)break;const S=i.indexOf(";",u),b=S===-1?v:S;if(C>b){u=i.lastIndexOf(";",C-1)+1;continue}const O=r(i,u,C),$=t(i,C,O),E=i.slice(O,$);if(a[E]===void 0){let _=r(i,C+1,b),R=t(i,b,_);const z=p(i.slice(_,R));a[E]=z}u=b+1}while(u<v);return a}function r(i,o,a){do{const v=i.charCodeAt(o);if(v!==32&&v!==9)return o}while(++o<a);return a}function t(i,o,a){for(;o>a;){const v=i.charCodeAt(--o);if(v!==32&&v!==9)return o+1}return a}function n(i,o,a){const v=a?.encode||encodeURIComponent;if(!l.test(i))throw new TypeError(`argument name is invalid: ${i}`);const p=v(o);if(!f.test(p))throw new TypeError(`argument val is invalid: ${o}`);let u=i+"="+p;if(!a)return u;if(a.maxAge!==void 0){if(!Number.isInteger(a.maxAge))throw new TypeError(`option maxAge is invalid: ${a.maxAge}`);u+="; Max-Age="+a.maxAge}if(a.domain){if(!c.test(a.domain))throw new TypeError(`option domain is invalid: ${a.domain}`);u+="; Domain="+a.domain}if(a.path){if(!h.test(a.path))throw new TypeError(`option path is invalid: ${a.path}`);u+="; Path="+a.path}if(a.expires){if(!m(a.expires)||!Number.isFinite(a.expires.valueOf()))throw new TypeError(`option expires is invalid: ${a.expires}`);u+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(u+="; HttpOnly"),a.secure&&(u+="; Secure"),a.partitioned&&(u+="; Partitioned"),a.priority)switch(typeof a.priority=="string"?a.priority.toLowerCase():void 0){case"low":u+="; Priority=Low";break;case"medium":u+="; Priority=Medium";break;case"high":u+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${a.priority}`)}if(a.sameSite)switch(typeof a.sameSite=="string"?a.sameSite.toLowerCase():a.sameSite){case!0:case"strict":u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"none":u+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${a.sameSite}`)}return u}function s(i){if(i.indexOf("%")===-1)return i;try{return decodeURIComponent(i)}catch{return i}}function m(i){return w.call(i)==="[object Date]"}return x}var k={exports:{}},j;function L(){if(j)return k.exports;j=1;var l={decodeValues:!0,map:!1,silent:!1};function f(e){return typeof e=="string"&&!!e.trim()}function c(e,r){var t=e.split(";").filter(f),n=t.shift(),s=h(n),m=s.name,i=s.value;r=r?Object.assign({},l,r):l;try{i=r.decodeValues?decodeURIComponent(i):i}catch(a){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+i+"'. Set options.decodeValues to false to disable this feature.",a)}var o={name:m,value:i};return t.forEach(function(a){var v=a.split("="),p=v.shift().trimLeft().toLowerCase(),u=v.join("=");p==="expires"?o.expires=new Date(u):p==="max-age"?o.maxAge=parseInt(u,10):p==="secure"?o.secure=!0:p==="httponly"?o.httpOnly=!0:p==="samesite"?o.sameSite=u:o[p]=u}),o}function h(e){var r="",t="",n=e.split("=");return n.length>1?(r=n.shift(),t=n.join("=")):t=e,{name:r,value:t}}function w(e,r){if(r=r?Object.assign({},l,r):l,!e)return r.map?{}:[];if(e.headers)if(typeof e.headers.getSetCookie=="function")e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var t=e.headers[Object.keys(e.headers).find(function(s){return s.toLowerCase()==="set-cookie"})];!t&&e.headers.cookie&&!r.silent&&console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=t}if(Array.isArray(e)||(e=[e]),r=r?Object.assign({},l,r):l,r.map){var n={};return e.filter(f).reduce(function(s,m){var i=c(m,r);return s[i.name]=i,s},n)}else return e.filter(f).map(function(s){return c(s,r)})}function d(e){if(Array.isArray(e))return e;if(typeof e!="string")return[];var r=[],t=0,n,s,m,i,o;function a(){for(;t<e.length&&/\s/.test(e.charAt(t));)t+=1;return t<e.length}function v(){return s=e.charAt(t),s!=="="&&s!==";"&&s!==","}for(;t<e.length;){for(n=t,o=!1;a();)if(s=e.charAt(t),s===","){for(m=t,t+=1,a(),i=t;t<e.length&&v();)t+=1;t<e.length&&e.charAt(t)==="="?(o=!0,t=i,r.push(e.substring(n,m)),n=t):t=m+1}else t+=1;(!o||t>=e.length)&&r.push(e.substring(n,e.length))}return r}return k.exports=w,k.exports.parse=w,k.exports.parseString=c,k.exports.splitCookiesString=d,k.exports}var y={},q;function V(){if(q)return y;q=1;var l=y&&y.__assign||function(){return l=Object.assign||function(d){for(var e,r=1,t=arguments.length;r<t;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(d[n]=e[n])}return d},l.apply(this,arguments)};Object.defineProperty(y,"__esModule",{value:!0}),y.areCookiesEqual=y.hasSameProperties=y.createCookie=y.isBrowser=void 0;function f(){return typeof window<"u"}y.isBrowser=f;function c(d,e,r){var t=r.sameSite;t===!0&&(t="strict"),(t===void 0||t===!1)&&(t="lax");var n=l(l({},r),{sameSite:t});return delete n.encode,l({name:d,value:e},n)}y.createCookie=c;function h(d,e){var r=Object.getOwnPropertyNames(d),t=Object.getOwnPropertyNames(e);if(r.length!==t.length)return!1;for(var n=0;n<r.length;n++){var s=r[n];if(d[s]!==e[s])return!1}return!0}y.hasSameProperties=h;function w(d,e){var r=d.sameSite===e.sameSite;return typeof d.sameSite=="string"&&typeof e.sameSite=="string"&&(r=d.sameSite.toLowerCase()===e.sameSite.toLowerCase()),h(l(l({},d),{sameSite:void 0}),l(l({},e),{sameSite:void 0}))&&r}return y.areCookiesEqual=w,y}var P;function T(){if(P)return g;P=1;var l=g&&g.__assign||function(){return l=Object.assign||function(r){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var m in t)Object.prototype.hasOwnProperty.call(t,m)&&(r[m]=t[m])}return r},l.apply(this,arguments)};Object.defineProperty(g,"__esModule",{value:!0}),g.destroyCookie=g.setCookie=g.parseCookies=void 0;var f=D(),c=L(),h=V();function w(r,t){var n,s;return!((s=(n=r?.req)===null||n===void 0?void 0:n.headers)===null||s===void 0)&&s.cookie?f.parse(r.req.headers.cookie,t):h.isBrowser()?f.parse(document.cookie,t):{}}g.parseCookies=w;function d(r,t,n,s){var m,i;if(s===void 0&&(s={}),!((m=r?.res)===null||m===void 0)&&m.getHeader&&r.res.setHeader){if(!((i=r?.res)===null||i===void 0)&&i.finished)return console.warn('Not setting "'+t+'" cookie. Response has finished.'),console.warn("You should set cookie before res.send()"),{};var o=r.res.getHeader("Set-Cookie")||[];typeof o=="string"&&(o=[o]),typeof o=="number"&&(o=[]);var a=c.parse(o,{decodeValues:!1}),v=h.createCookie(t,n,s),p=[];a.forEach(function(u){if(!h.areCookiesEqual(u,v)){var C=f.serialize(u.name,u.value,l({encode:function(S){return S}},u));p.push(C)}}),p.push(f.serialize(t,n,s)),r.res.setHeader("Set-Cookie",p)}if(h.isBrowser()){if(s&&s.httpOnly)throw new Error("Can not set a httpOnly cookie in the browser.");document.cookie=f.serialize(t,n,s)}return{}}g.setCookie=d;function e(r,t,n){return d(r,t,"",l(l({},n||{}),{maxAge:-1}))}return g.destroyCookie=e,g.default={set:d,get:w,destroy:e},g}var I=T();class H extends N{constructor(f,c,h){super(f),this._req=c,this._res=h}set(f,c,h=12*30*24*60*60,w={encrypt:!0}){I.setCookie({res:this._res},f,this.encrypt(c,!w.encrypt),{maxAge:h,path:"/"})}remove(f){this.set(f,"",0)}get(f,c=!0){const h=this._parse(this._req?.headers?.cookie,f);if(h)return this.decrypt(decodeURIComponent(h),!c)}exist(f){return!!this.get(f)}getAllNames(){return Object.keys(I.parseCookies({req:this._req}))}encrypt(f,c){return c?f:this._encrypt(f)}decrypt(f,c){return c?f:super._decrypt(f)}}export{H as default};
