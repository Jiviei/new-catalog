import{e as n,W as _,G as y,o as b,H as v,J as g,P as r,K as f,N as u,O as p,T as o,Q as m}from"./index--Cfhpedu.js";function D(){return new h(m(),window.__TAURI_INTERNALS__.metadata.currentWebview.label,{skip:!0})}async function c(){return n("plugin:webview|get_all_webviews").then(s=>s.map(e=>new h(new _(e.windowLabel,{skip:!0}),e.label,{skip:!0})))}const w=["tauri://created","tauri://error"];class h{constructor(e,t,i){this.window=e,this.label=t,this.listeners=Object.create(null),i?.skip||n("plugin:webview|create_webview",{windowLabel:e.label,label:t,options:i}).then(async()=>this.emit("tauri://created")).catch(async l=>this.emit("tauri://error",l))}static async getByLabel(e){var t;return(t=(await c()).find(i=>i.label===e))!==null&&t!==void 0?t:null}static getCurrent(){return D()}static async getAll(){return c()}async listen(e,t){return this._handleTauriEvent(e,t)?()=>{const i=this.listeners[e];i.splice(i.indexOf(t),1)}:y(e,t,{target:{kind:"Webview",label:this.label}})}async once(e,t){return this._handleTauriEvent(e,t)?()=>{const i=this.listeners[e];i.splice(i.indexOf(t),1)}:b(e,t,{target:{kind:"Webview",label:this.label}})}async emit(e,t){if(w.includes(e)){for(const i of this.listeners[e]||[])i({event:e,id:-1,payload:t});return}return v(e,t)}async emitTo(e,t,i){if(w.includes(t)){for(const l of this.listeners[t]||[])l({event:t,id:-1,payload:i});return}return g(e,t,i)}_handleTauriEvent(e,t){return w.includes(e)?(e in this.listeners?this.listeners[e].push(t):this.listeners[e]=[t],!0):!1}async position(){return n("plugin:webview|webview_position",{label:this.label}).then(e=>new r(e))}async size(){return n("plugin:webview|webview_size",{label:this.label}).then(e=>new f(e))}async close(){return n("plugin:webview|close",{label:this.label})}async setSize(e){return n("plugin:webview|set_webview_size",{label:this.label,value:e instanceof u?e:new u(e)})}async setPosition(e){return n("plugin:webview|set_webview_position",{label:this.label,value:e instanceof p?e:new p(e)})}async setFocus(){return n("plugin:webview|set_webview_focus",{label:this.label})}async hide(){return n("plugin:webview|webview_hide",{label:this.label})}async show(){return n("plugin:webview|webview_show",{label:this.label})}async setZoom(e){return n("plugin:webview|set_webview_zoom",{label:this.label,value:e})}async reparent(e){return n("plugin:webview|reparent",{label:this.label,window:typeof e=="string"?e:e.label})}async clearAllBrowsingData(){return n("plugin:webview|clear_all_browsing_data")}async setBackgroundColor(e){return n("plugin:webview|set_webview_background_color",{color:e})}async onDragDropEvent(e){const t=await this.listen(o.DRAG_ENTER,a=>{e({...a,payload:{type:"enter",paths:a.payload.paths,position:new r(a.payload.position)}})}),i=await this.listen(o.DRAG_OVER,a=>{e({...a,payload:{type:"over",position:new r(a.payload.position)}})}),l=await this.listen(o.DRAG_DROP,a=>{e({...a,payload:{type:"drop",paths:a.payload.paths,position:new r(a.payload.position)}})}),d=await this.listen(o.DRAG_LEAVE,a=>{e({...a,payload:{type:"leave"}})});return()=>{t(),l(),i(),d()}}}const T=async({url:s,redirect:e})=>{const t={onLoadApp:void 0,focus:()=>{}};return await b("on_done",i=>t.onLoadApp({search:"?"+i.payload})),e?await n("http_listen_once",{url:s.replace(/\?redirect=.*$/,`?redirect=${encodeURIComponent("http://localhost:52054")}`),redirect:e,callbackName:"on_done"}):window.location.replace(s),t},A=()=>n("open_directory"),W=s=>n("http_request",{req:s}),k=s=>n("move_to_trash",{path:s}),R=s=>n("open_in_explorer",{path:s}),L=(s,e)=>n("set_session_data",{key:s,data:e}),O=s=>n("open_window_with_url",{url:s});window.reloadAll=async()=>{const s=await c();for(const e of s)setTimeout(()=>void e.emit("reload"),100)};export{W as httpFetch,k as moveToTrash,T as openChildWindow,A as openDirectory,R as openInExplorer,O as openWindowWithUrl,L as setSessionData};
